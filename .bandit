# Bandit configuration for VS Code Extension Security Scanner
# AST-based Python security vulnerability scanner
#
# Usage:
#   bandit -r vscode_scanner/ -ll
#   bandit -r vscode_scanner/ -f json -o bandit-report.json
#
# Documentation: https://bandit.readthedocs.io/

[bandit]
# Exclude test directories and non-source files
exclude_dirs = ['/tests', '/node_modules', '/.git', '/build', '/dist', '/__pycache__']

# Security tests to run (all relevant tests enabled)
tests = [
    # Injection vulnerabilities (B201-B324)
    'B201',  # flask_debug_true
    'B301',  # pickle (unsafe deserialization)
    'B302',  # marshal (unsafe deserialization)
    'B303',  # md5/sha1 (weak cryptography)
    'B304',  # ciphers (weak cryptography)
    'B305',  # cipher_modes (weak cryptography)
    'B306',  # mktemp_q (insecure temp file)
    'B307',  # eval (code injection)
    'B308',  # mark_safe (XSS risk)
    'B309',  # httpsconnection (SSL verification)
    'B310',  # urllib_urlopen (HTTPS enforcement)
    'B311',  # random (weak random)
    'B312',  # telnetlib (insecure protocol)
    'B313',  # xml_bad_cElementTree (XML vulnerabilities)
    'B314',  # xml_bad_ElementTree (XML vulnerabilities)
    'B315',  # xml_bad_expatreader (XML vulnerabilities)
    'B316',  # xml_bad_expatbuilder (XML vulnerabilities)
    'B317',  # xml_bad_sax (XML vulnerabilities)
    'B318',  # xml_bad_minidom (XML vulnerabilities)
    'B319',  # xml_bad_pulldom (XML vulnerabilities)
    'B320',  # xml_bad_etree (XML vulnerabilities)
    'B321',  # ftplib (insecure protocol)
    'B323',  # unverified_context (SSL)
    'B324',  # hashlib_new_insecure_functions (weak hashing)
    'B325',  # tempnam (insecure temp file)

    # Cryptography issues (B501-B507) - CRITICAL for HMAC implementation
    'B501',  # request_with_no_cert_validation
    'B502',  # ssl_with_bad_version
    'B503',  # ssl_with_bad_defaults
    'B504',  # ssl_with_no_version
    'B505',  # weak_cryptographic_key
    'B506',  # yaml_load (unsafe deserialization)
    'B507',  # ssh_no_host_key_verification

    # Shell and subprocess issues (B601-B611) - CRITICAL for CLI tool
    'B601',  # paramiko_calls
    'B602',  # subprocess_popen_with_shell_equals_true
    'B603',  # subprocess_without_shell_equals_true
    'B604',  # any_other_function_with_shell_equals_true
    'B605',  # start_process_with_a_shell
    'B606',  # start_process_with_no_shell
    'B607',  # start_process_with_partial_path
    'B608',  # hardcoded_sql_expressions (SQL injection)
    'B609',  # linux_commands_wildcard_injection
    'B610',  # django_extra_used
    'B611',  # django_rawsql_used

    # XML/network vulnerabilities (B701-B703)
    'B701',  # jinja2_autoescape_false (XSS)
    'B702',  # use_of_mako_templates (XSS)
    'B703',  # django_mark_safe (XSS)
]

# Skip these tests (none - all enabled)
skips = []

# Only report high and medium severity issues
severity: medium
confidence: medium

# Output formatting
# json: Use for CI/CD integration
# screen: Use for terminal output
# csv: Use for spreadsheet analysis
# html: Use for detailed reports
